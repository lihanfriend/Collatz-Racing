<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Collatz Racing</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
/* Animations */
@keyframes pulse-glow {0%,100%{box-shadow:0 0 20px rgba(59,130,246,0.5);}50%{box-shadow:0 0 40px rgba(59,130,246,0.8);} }
.pulse-glow{animation:pulse-glow 2s ease-in-out infinite;}
@keyframes slide-in{from{transform:translateY(-20px);opacity:0;}to{transform:translateY(0);opacity:1;}}
.slide-in{animation:slide-in 0.5s ease-out;}
@keyframes shake{0%,100%{transform:translateX(0);}10%,30%,50%,70%,90%{transform:translateX(-10px);}20%,40%,60%,80%{transform:translateX(10px);} }
.shake{animation:shake 0.5s ease-in-out;}
</style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen text-white">
<div class="container mx-auto px-4 py-8 max-w-4xl">

  <!-- Login Screen -->
  <div id="loginScreen" class="bg-white/10 backdrop-blur-md rounded-2xl p-8 text-center border border-white/20">
    <div class="text-6xl mb-4">üîê</div>
    <h2 class="text-3xl font-bold mb-4">Sign in to Play</h2>
    <p class="text-gray-300 mb-6">Sign in with Google to challenge friends and track your rating.</p>
    <button id="loginBtn"
      class="bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-bold py-4 px-8 rounded-lg transition-all transform hover:scale-105 pulse-glow text-xl">
      Sign in with Google
    </button>
    <div id="userInfo" class="mt-4 text-gray-300 text-sm hidden"></div>
  </div>

  <!-- Lobby / Duel Screen -->
  <div id="duelLobby" class="hidden bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20 space-y-6">
    <div class="text-center">
      <h2 class="text-3xl font-bold mb-2">Collatz Racing Lobby</h2>
      <p class="text-sm text-gray-400" id="userInfo2"></p>
    </div>
    
    <div class="text-center space-y-4">
      <button id="createDuelBtn" 
        class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-bold py-3 px-8 rounded-lg transition-all transform hover:scale-105 w-full max-w-md">
        Create Duel
      </button>
      
      <div class="flex gap-2 max-w-md mx-auto">
        <input type="text" id="duelIDInput" placeholder="Enter Duel Code" 
          class="flex-1 px-4 py-3 rounded-lg text-black text-center font-mono uppercase tracking-wider"
          maxlength="6">
        <button id="joinDuelBtn" 
          class="bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-bold py-3 px-8 rounded-lg transition-all transform hover:scale-105">
          Join Duel
        </button>
      </div>
    </div>
    
    <p class="text-gray-300 text-center min-h-[24px]" id="duelStatus"></p>
    
    <div class="text-center pt-4 border-t border-white/10">
      <button id="logoutBtn" class="text-sm text-red-400 hover:text-red-300 underline transition-colors">
        Sign out
      </button>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="gameScreen" class="hidden space-y-6">
    <!-- Stats -->
    <div class="grid grid-cols-2 gap-4">
      <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 text-center border border-white/20">
        <p class="text-sm text-gray-400 mb-1">Your Number</p>
        <p class="text-3xl font-bold text-yellow-400" id="currentNumber"></p>
        <p class="text-sm text-gray-400 mt-1">Steps: <span id="stepCount">0</span></p>
      </div>
      <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 text-center border border-white/20">
        <p class="text-sm text-gray-400 mb-1">Opponent's Number</p>
        <p class="text-3xl font-bold text-pink-400" id="opponentNumber">?</p>
        <p class="text-sm text-gray-400 mt-1">Steps: <span id="opponentStepCount">0</span></p>
      </div>
    </div>

    <!-- Input -->
    <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
      <label class="block text-center text-lg font-semibold mb-4 text-gray-300">What's the next number?</label>
      <div class="flex gap-3">
        <input type="number" id="answerInput"
          class="flex-1 px-6 py-4 bg-white/20 border-2 border-blue-500/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white text-3xl text-center font-bold placeholder-gray-400"
          placeholder="?" autofocus>
        <button id="submitBtn"
          class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-bold py-4 px-8 rounded-lg transition-all transform hover:scale-105 text-xl">
          Submit
        </button>
      </div>
      <div id="feedback" class="mt-4 text-center text-lg font-semibold h-8"></div>
      <div class="mt-2 text-center text-sm text-gray-400">Time: <span id="timer">0.0s</span></div>
    </div>
  </div>

  <!-- Result Screen -->
  <div id="resultScreen" class="hidden bg-white/10 backdrop-blur-md rounded-2xl p-8 text-center border border-white/20 slide-in">
    <div class="text-8xl mb-6" id="resultEmoji"></div>
    <h2 class="text-4xl font-bold mb-4" id="resultTitle"></h2>
    <div class="bg-white/5 rounded-lg p-6 mb-6 max-w-md mx-auto">
      <div class="grid grid-cols-2 gap-4 text-left">
        <div>
          <p class="text-sm text-gray-400">Your Steps</p>
          <p class="text-2xl font-bold text-blue-400" id="finalSteps"></p>
        </div>
        <div>
          <p class="text-sm text-gray-400">Time</p>
          <p class="text-2xl font-bold text-purple-400" id="finalTime"></p>
        </div>
      </div>
    </div>
    <button id="returnLobbyBtn"
      class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-bold py-3 px-8 rounded-lg transition-all transform hover:scale-105">
      Return to Lobby
    </button>
  </div>
</div>

<!-- Load firebase libs (these are used by index.js which is a module) -->
<script type="module" src="index.js"></script>
</body>
</html>
